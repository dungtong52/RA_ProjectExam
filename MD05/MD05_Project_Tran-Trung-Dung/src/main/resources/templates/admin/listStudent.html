<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:fragment="title">List Account</title>
    <link rel="stylesheet" th:href="@{/css/reset.css}">
    <link rel="stylesheet" th:href="@{/css/admin/adminStyle.css}">
    <link rel="stylesheet" th:href="@{/css/admin/headerStyle.css}">
    <link rel="stylesheet" th:href="@{/css/admin/sidebarStyle.css}">
    <link rel="stylesheet" th:href="@{/css/admin/listStudentStyle.css}">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL@24,200,0&display=block" rel="stylesheet">
</head>
<body>
<header th:replace="~{admin/component/header :: header-fragment}"></header>

<!--Success & Error-->
<div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
<div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

<div class="main-container">
    <aside th:replace="~{admin/component/sidebar :: sidebar-fragment}"></aside>

    <main class="main-content">
        <div class="student-manager-header">
            <h2>Student Manager</h2>
            <div class="student-manager-controls">
                <form th:action="@{/admin/users}" method="get">
                    <select name="sortParam" id="sort">
                        <option value="id_asc" th:selected="${sort == 'id_asc'}">
                            Sort By ID ASC
                        </option>
                        <option value="id_desc" th:selected="${sort == 'id_desc'}">
                            Sort By ID DESC
                        </option>
                        <option value="name_asc" th:selected="${sort == 'name_asc'}">
                            Sort By Name ASC
                        </option>
                        <option value="name_desc" th:selected="${sort == 'name_desc'}">
                            Sort By Name DESC
                        </option>
                    </select>

                    <input type="text" name="keyword" placeholder="search by id, email or name"
                           th:value="${keyword}">

                    <button type="submit">Search</button>
                </form>
            </div>

        </div>

        <div class="student-table-container">
            <table class="student-table">
                <thead>
                <tr>
                    <th>Student ID</th>
                    <th>Student Name</th>
                    <th>Email</th>
                    <th>Gender</th>
                    <th>Phone</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="student : ${students}">
                    <td th:text="'S0' + ${student.id}"></td>
                    <td th:text="${student.name}"></td>
                    <td th:text="${student.email}"></td>
                    <td th:text="${student.sex} ? 'Male' : 'Female'"></td>
                    <td th:text="${student.phone}"></td>
                    <td>
                        <span th:classappend="${student.status} ? 'status-active' : 'status-inactive'"
                              th:text="${student.status} ? 'Active' : 'Inactive'">Active</span>
                    </td>
                    <td class="action-buttons">
                        <a
                                th:href="@{user/{id}(id=${student.id}, page=${currentPage})}"
                                th:classappend="${student.status} ? 'lock' : 'unlock'"
                                th:text="${student.status} ? 'Lock' : 'Unlock'">Lock
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="pagination">
            <a th:if="${currentPage > 0}"
               th:href="@{/admin/users(page=${currentPage - 1}, size=${pageSize}, keyword=${keyword}, sort=${sort})}"
               class="arrow">&larr;</a>

            <a th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
               th:href="@{/admin/users(page=${i}, size=${pageSize}, keyword=${keyword}, sort=${sort})}"
               th:text="${i+1}"
               th:classappend="${i == currentPage} ? 'active pag-btn' : 'pag-btn'">
            </a>

            <a th:if="${currentPage < totalPages - 1}"
               th:href="@{/admin/users(page=${currentPage + 1}, size=${pageSize}, keyword=${keyword}, sort=${sort})}"
               class="arrow">&rarr;</a>
        </div>
    </main>
</div>
</body>
</html>